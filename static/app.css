*{ box-sizing:border-box; }
html,body{ margin:0; padding:0; }

:root{
  --bg: #f5f7fb;
  --bg-grad: radial-gradient(circle at 20% 20%, #eef2ff 0%, rgba(238,242,255,0) 45%),
             radial-gradient(circle at 85% 10%, #f1f5f9 0%, rgba(241,245,249,0) 35%),
             linear-gradient(180deg, #f8fafc 0%, #f4f6fb 100%);
  --panel: #ffffff;
  --panel-2: #f8fafc;
  --text: #0f172a;
  --muted: #64748b;
  --border: rgba(148,163,184,.35);
  --border-strong: rgba(148,163,184,.5);

  --accent: #4f46e5;
  --accent-2: #6d28d9;
  --accent-soft: rgba(79,70,229,.12);

  --success: #15803d;
  --success-soft: rgba(22,163,74,.12);
  --danger: #b91c1c;
  --danger-soft: rgba(220,38,38,.12);
  --warning: #b45309;
  --warning-soft: rgba(234,88,12,.12);

  --shadow: 0 12px 30px rgba(15,23,42,.08);
  --shadow-lg: 0 20px 50px rgba(15,23,42,.12);
  --radius: 18px;
  --radius-sm: 12px;
  --radius-lg: 22px;
  --card-pad: 16px;
}

html[data-theme="dark"]{
  --bg: #0b1020;
  --bg-grad: radial-gradient(circle at 20% 20%, #111827 0%, rgba(17,24,39,0) 45%),
             radial-gradient(circle at 85% 10%, #0f172a 0%, rgba(15,23,42,0) 35%),
             linear-gradient(180deg, #0b1020 0%, #0c1222 100%);
  --panel: #101827;
  --panel-2: #0f172a;
  --text: #e2e8f0;
  --muted: #94a3b8;
  --border: rgba(148,163,184,.2);
  --border-strong: rgba(148,163,184,.35);

  --accent: #7c3aed;
  --accent-2: #4f46e5;
  --accent-soft: rgba(124,58,237,.18);

  --success: #22c55e;
  --success-soft: rgba(34,197,94,.12);
  --danger: #f87171;
  --danger-soft: rgba(248,113,113,.15);
  --warning: #f59e0b;
  --warning-soft: rgba(245,158,11,.15);

  --shadow: 0 12px 30px rgba(2,6,23,.35);
  --shadow-lg: 0 20px 60px rgba(2,6,23,.5);
}

body{
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color: var(--text);
  background: var(--bg);
  background-image: var(--bg-grad);
  line-height: 1.45;
}
a{ color:inherit; text-decoration:none; }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
.muted{ color:var(--muted); }
.right{ text-align:right; }

.app{ min-height:100vh; display:flex; flex-direction:column; }
.layout{ min-height:100vh; display:flex; }
.main{ flex:1; width:100%; padding:24px 20px 32px; }
.container{ max-width:1280px; margin:0 auto; width:100%; }

.sidebar{
  width:250px;
  background: linear-gradient(180deg, var(--panel) 0%, color-mix(in srgb, var(--panel) 86%, #0b1020 14%) 100%);
  border-right:1px solid var(--border);
  position:sticky;
  top:0;
  height:100vh;
  display:flex;
  flex-direction:column;
  padding:16px 12px;
  gap:12px;
}
.sidebar-brand{ display:flex; align-items:center; gap:10px; padding:8px 6px 4px; }
.sidebar-nav{ display:flex; flex-direction:column; gap:14px; padding:4px 6px; }
.sidebar-group{ display:flex; flex-direction:column; gap:6px; }
.sidebar-label{
  font-size:11px; text-transform:uppercase; letter-spacing:.4px;
  color:var(--muted); margin:4px 8px 2px;
}
.sidebar-footer{
  margin-top:auto;
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:8px 6px 4px;
}

.topbar{
  position:sticky;
  top:0;
  z-index:40;
  background: color-mix(in srgb, var(--panel) 75%, transparent);
  backdrop-filter: blur(14px);
  border-bottom:1px solid var(--border);
}
.topbar-inner{
  max-width:1200px;
  margin:0 auto;
  padding:12px 16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
}
.brand{ display:flex; align-items:center; gap:12px; }
.brand-badge{
  width:40px; height:40px; border-radius:14px;
  display:flex; align-items:center; justify-content:center;
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  color:#fff; font-weight:800; letter-spacing:.5px;
  box-shadow: var(--shadow);
}
.brand-name{ font-weight:800; letter-spacing:.2px; }
.brand-sub{ font-size:12px; color:var(--muted); margin-top:2px; }
.topbar-right{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; justify-content:flex-end; }

.nav{ display:flex; gap:8px; flex-wrap:wrap; }
.navlink{
  padding:8px 12px;
  border-radius:999px;
  border:1px solid transparent;
  color:var(--muted);
  font-size:13px;
  transition: background .2s ease, border-color .2s ease, color .2s ease;
}
.navlink:hover{
  background: var(--accent-soft);
  border-color: color-mix(in srgb, var(--accent) 35%, transparent);
  color: var(--text);
}
.navlink-vert{
  border-radius:12px;
  padding:8px 10px;
  border:1px solid transparent;
}
.navlink-vert:hover{
  background: color-mix(in srgb, var(--accent) 10%, transparent);
  border-color: color-mix(in srgb, var(--accent) 35%, transparent);
}

.page{ display:flex; flex-direction:column; gap:14px; width:100%; }
.page-head{ display:flex; align-items:flex-end; justify-content:space-between; gap:12px; }
.h1{ font-size:22px; font-weight:800; letter-spacing:-.3px; }
.h2{ font-size:16px; font-weight:800; letter-spacing:-.2px; }

.grid{ display:grid; gap:12px; }
.grid-2{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
.grid-3{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
.grid-4{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
.row{ display:flex; align-items:center; }
.gap-8{ gap:8px; }
.gap-10{ gap:10px; }
.gap-12{ gap:12px; }
.row-wrap{ flex-wrap:wrap; }
.row-end{ justify-content:flex-end; }
.items-end{ align-items:flex-end; }
.w-full{ width:100%; }
.w-140{ width:140px; }
.w-160{ width:160px; }
.minw-0{ min-width:0; }
.minw-520{ min-width:520px; }
.minw-980{ min-width:980px; }
.mt-6{ margin-top:6px; }
.mt-8{ margin-top:8px; }
.mt-10{ margin-top:10px; }
.mb-8{ margin-bottom:8px; }
.mb-10{ margin-bottom:10px; }
.mb-12{ margin-bottom:12px; }
.ml-8{ margin-left:8px; }
.section-sm{ margin-top:8px; }
.section-md{ margin-top:10px; }
.text-xs{ font-size:12px; }
.text-danger{ color:var(--danger); }
.hidden{ display:none; }
.section{ margin-top:12px; }
.section-lg{ margin-top:18px; }
.status-row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }

@media (max-width: 980px){
  .grid-4{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .grid-3{ grid-template-columns: 1fr; }
  .grid-2{ grid-template-columns: 1fr; }
  .page-head{ flex-direction:column; align-items:flex-start; }
  .layout{ flex-direction:column; }
  .sidebar{
    width:100%;
    height:auto;
    position:relative;
    border-right:none;
    border-bottom:1px solid var(--border);
  }
  .sidebar-nav{ flex-direction:row; flex-wrap:wrap; }
  .sidebar-group{ width:100%; }
}
@media (max-width: 520px){
  .grid-4{ grid-template-columns: 1fr; }
}

.card{
  background: linear-gradient(180deg, var(--panel) 0%, color-mix(in srgb, var(--panel) 90%, #ffffff 10%) 100%);
  border:1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: var(--card-pad);
}
.card-stat{
  background: linear-gradient(145deg, var(--panel) 0%, color-mix(in srgb, var(--accent) 6%, var(--panel) 94%) 100%);
}
.card-head{
  display:flex; align-items:flex-start; justify-content:space-between;
  gap:12px; margin-bottom:10px;
}
.card-label{ font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.4px; }
.card-value{ font-size:22px; font-weight:900; letter-spacing:-.2px; margin-top:6px; }
.card-sub{ margin-top:6px; font-size:12px; color:var(--muted); }

.pos{ color:var(--success); }
.neg{ color:var(--danger); }

.btn{
  display:inline-flex; align-items:center; justify-content:center;
  padding:9px 12px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  color:var(--text);
  font-size:13px;
  font-weight:700;
  cursor:pointer;
  transition: transform .04s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
.btn:hover{
  border-color: var(--border-strong);
  box-shadow: 0 0 0 4px var(--accent-soft);
}
.btn:active{ transform: translateY(1px); }
.btn:disabled{ opacity:.6; cursor:not-allowed; box-shadow:none; }
.btn-purple{
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
  border-color: color-mix(in srgb, var(--accent) 60%, transparent);
  color:#fff;
}
.btn-purple:hover{ box-shadow: 0 0 0 4px var(--accent-soft); }
.btn-neg{
  border-color: color-mix(in srgb, var(--danger) 50%, transparent);
  color: var(--danger);
}
.btn-neg:hover{ box-shadow: 0 0 0 4px var(--danger-soft); }
.btn-ghost{
  background: transparent;
  border-color: transparent;
  color: var(--muted);
}
.btn-ghost:hover{
  border-color: var(--border);
  background: var(--panel-2);
  color: var(--text);
}

.tag{
  display:inline-flex; align-items:center; justify-content:center;
  padding:4px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  font-size:12px;
  font-weight:700;
  color:var(--muted);
}
.tag-buy{
  background: linear-gradient(135deg, var(--success-soft) 0%, color-mix(in srgb, var(--success) 18%, transparent) 100%);
  border-color: color-mix(in srgb, var(--success) 45%, transparent);
  color: var(--success);
}
.tag-pos{ background: var(--success-soft); border-color: color-mix(in srgb, var(--success) 40%, transparent); color: var(--success); }
.tag-neg{ background: var(--danger-soft); border-color: color-mix(in srgb, var(--danger) 40%, transparent); color: var(--danger); }
.tag-warn{ background: var(--warning-soft); border-color: color-mix(in srgb, var(--warning) 40%, transparent); color: var(--warning); }

.status-pill{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  font-size:12px;
  color:var(--muted);
  white-space: nowrap;
}
.status-pill.status-ok{
  color: var(--success);
  border-color: color-mix(in srgb, var(--success) 40%, transparent);
  background: var(--success-soft);
}
.status-pill.status-warn{
  color: var(--warning);
  border-color: color-mix(in srgb, var(--warning) 40%, transparent);
  background: var(--warning-soft);
}
.status-pill.status-running{
  color: #22c55e;
  border-color: color-mix(in srgb, #22c55e 40%, transparent);
  background: color-mix(in srgb, #22c55e 15%, transparent);
}
.status-pill.status-error{
  color: var(--danger);
  border-color: color-mix(in srgb, var(--danger) 40%, transparent);
  background: var(--danger-soft);
}
.status-pill.status-paused{
  color: var(--muted);
  border-color: var(--border);
  background: var(--panel);
}
.badge-mode{
  display: inline-flex; align-items: center; padding: 6px 12px;
  border-radius: 999px; font-size: 12px; font-weight: 600;
}
.badge-autopilot{
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  color: white; border: none;
}
.badge-manual{
  background: linear-gradient(135deg, #64748b 0%, #475569 100%);
  color: white; border: none;
}
.tag.status-st-running{ background: color-mix(in srgb, #22c55e 15%, transparent); color: #22c55e; border-color: color-mix(in srgb, #22c55e 40%, transparent); }
.tag.status-st-error{ background: var(--danger-soft); color: var(--danger); border-color: color-mix(in srgb, var(--danger) 40%, transparent); }
.tag.status-st-paused{ background: var(--panel); color: var(--muted); border-color: var(--border); }

.reco-list{
  display: flex;
  flex-direction: column;
  gap: 0;
}
.reco-list > div{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
}
.reco-list > div:last-child{ border-bottom: none; }

.table-wrap{
  overflow:auto;
  border-radius: var(--radius-sm);
  border:1px solid var(--border);
  background: var(--panel);
}
.table{ width:100%; border-collapse:collapse; min-width:520px; }
.table th{
  text-align:left;
  padding:10px 12px;
  font-size:12px;
  font-weight:700;
  color:var(--muted);
  background: var(--panel-2);
  position: sticky;
  top:0;
  z-index:2;
}
.table td{
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  font-size:13px;
}
.table tbody tr:nth-child(even) td{ background: color-mix(in srgb, var(--panel-2) 65%, transparent); }
.table tr:hover td{ background: color-mix(in srgb, var(--accent) 7%, transparent); }

.input{
  width:100%;
  padding:10px 10px;
  border-radius:12px;
  border:1px solid var(--border);
  background: var(--panel);
  color:var(--text);
  font-size:13px;
  transition: box-shadow .18s ease, border-color .18s ease;
}
.input-sm{ padding:8px 10px; }
.input::placeholder{ color: color-mix(in srgb, var(--muted) 70%, transparent); }
.input:focus{
  outline:none;
  border-color: color-mix(in srgb, var(--accent) 55%, transparent);
  box-shadow: 0 0 0 4px var(--accent-soft);
}

.label{
  font-size:12px;
  color:var(--muted);
  text-transform:uppercase;
  letter-spacing:.4px;
  margin-bottom:6px;
}

.coins-grid{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; }
.coin{
  display:flex; align-items:center; gap:12px;
  padding:14px;
  border-radius: var(--radius);
  border:1px solid var(--border);
  background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
  transition: box-shadow .2s ease, transform .05s ease, border-color .2s ease;
}
.coin:hover{
  border-color: color-mix(in srgb, var(--accent) 40%, transparent);
  box-shadow: 0 0 0 4px var(--accent-soft);
}
.coin:active{ transform: translateY(1px); }
.coin-ico{
  width:42px; height:42px; border-radius:14px;
  display:flex; align-items:center; justify-content:center;
  font-weight:900;
  background: color-mix(in srgb, var(--accent) 15%, transparent);
  color:var(--text);
}
.coin-meta{ flex:1; min-width:0; }
.coin-name{ font-weight:800; }
.coin-sub{ font-size:12px; }
.coin-price{ font-size:14px; font-weight:800; }
@media (max-width: 980px){
  .coins-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}
@media (max-width: 520px){
  .coins-grid{ grid-template-columns: 1fr; }
}

.logbox{
  background: var(--panel);
  border:1px solid var(--border);
  border-radius: var(--radius-sm);
  padding:12px;
  min-height:120px;
  max-height:360px;
  overflow:auto;
  overflow-x:auto;
  white-space: pre-wrap;
  font-size:12px;
  line-height:1.5;
}
.logbox-large{ min-height:220px; max-height:320px; }
.log-line{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  padding:2px 0 2px 8px;
  border-left:3px solid transparent;
  border-bottom:1px dashed color-mix(in srgb, var(--border) 60%, transparent);
}
.log-line:last-child{ border-bottom:none; }
.log-info{ color:var(--text); border-left-color: color-mix(in srgb, var(--muted) 50%, transparent); }
.log-warn{ color:var(--warning); border-left-color: var(--warning); }
.log-neg{ color:var(--danger); border-left-color: var(--danger); }
.log-muted{ color:var(--muted); border-left-color: color-mix(in srgb, var(--muted) 50%, transparent); }
.log-order{ color:var(--success); border-left-color: var(--success); }
.log-risk{ color:var(--warning); border-left-color: var(--warning); }
.log-data{ color:var(--accent-2); border-left-color: var(--accent); }

.modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:60; }
.modal.hidden{ display:none; }
.modal-backdrop{ position:absolute; inset:0; background: rgba(2,6,23,.55); backdrop-filter: blur(4px); }
.modal-card{
  position:relative;
  z-index:2;
  width:min(880px, calc(100vw - 32px));
  max-height: calc(100vh - 40px);  /* Leave 20px margin top/bottom */
  overflow-y: auto;  /* Make it scrollable */
  background: var(--panel);
  border-radius: var(--radius-lg);
  border:1px solid var(--border);
  box-shadow: var(--shadow-lg);
  padding:16px;
}
.modal-head{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; }

.symbol-dropdown{
  position:absolute;
  top:100%;
  left:0;
  right:0;
  max-height:300px;
  overflow-y:auto;
  background: var(--panel);
  border:1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  z-index:1000;
  margin-top:4px;
}
.symbol-dropdown-item{
  padding:10px 12px;
  cursor:pointer;
  border-bottom:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.symbol-dropdown-item:last-child{ border-bottom:none; }
.symbol-dropdown-item:hover{
  background: var(--accent-soft);
}
.symbol-dropdown-item .symbol-code{
  font-weight:600;
  font-family: var(--font-mono);
}
.symbol-dropdown-item .symbol-name{
  color: var(--text-muted);
  font-size:12px;
}
.symbol-dropdown-empty{
  padding:12px;
  text-align:center;
  color: var(--text-muted);
  font-size:14px;
}

.chip{
  display:inline-flex; align-items:center; justify-content:center;
  padding:6px 10px; border-radius:999px;
  border:1px solid var(--border);
  background: var(--panel);
  font-size:12px; cursor:pointer;
}
.chip:hover{ border-color: var(--border-strong); box-shadow: 0 0 0 4px var(--accent-soft); }

.bot-layout{ grid-template-columns: 2fr 1fr; gap:12px; }
.bot-layout-narrow{ grid-template-columns: 1fr 320px; gap:12px; }
.bot-main{ min-width:0; }
.bot-side{ min-width:0; }
@media (max-width: 980px){
  .bot-layout{ grid-template-columns: 1fr; }
  .bot-layout-narrow{ grid-template-columns: 1fr; }
}

.tab-btn.tab-active{
  border-color: color-mix(in srgb, var(--accent) 45%, transparent);
  background: var(--accent-soft);
}

.spark{ display:block; }

.chart-candle{ height:420px; width:100%; }
.chart-drawdown{ height:160px; width:100%; }
.chart-pnl{ height:220px; width:100%; }

.auth-card{ max-width:420px; margin:48px auto; }

.footer{
  border-top:1px solid var(--border);
  margin-top:auto;
  background: color-mix(in srgb, var(--panel) 75%, transparent);
}
.footer-inner{
  max-width:1200px;
  margin:0 auto;
  padding:14px 16px;
  display:flex;
  justify-content:space-between;
  gap:16px;
  font-size:12px;
  color:var(--muted);
}
.kbd{
  display:inline-flex; align-items:center; justify-content:center;
  padding:2px 6px; border:1px solid var(--border);
  border-radius:6px; background: var(--panel);
  font-size:11px; color:var(--text);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}

.pwa-install-banner{ padding:8px 0; }
.pwa-install-banner.hidden{ display:none !important; }

@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}
